/* ----------------------------------------------------*/
/* ИМЯ: Афонина Софья ID пользователя: 23К0094 */
/* ДАТА: 22/09/2025 */
/* ИМЯ ФАЙЛА: process.c */
/* НАЗНАЧЕНИЕ ПРОГРАММЫ: */
/* Дочерний процесс, ожидающий сигналов от родительского */
/* процесса и корректно завершающий работу по сигналу */
/* ----------------------------------------------------*/

#include <stdio.h>
#include <stdlib.h>
#include <signal.h>
#include <unistd.h>

/* ----------------------------------------------------*/
/* ФУНКЦИЯ child_handler : обработчик сигналов */
/* назначение этой функции: обработка сигнала SIGUSR1 */
/* ИСПОЛЬЗОВАНИЕ ПАРАМЕТРА: */
/* int sig - номер полученного сигнала */
/* ВЫЗЫВАЕМАЯ ФУНКЦИЯ: */
/* printf - вывод сообщения на экран */
/* exit - завершение процесса */
/* ----------------------------------------------------*/
void child_handler(int sig) {
    if (sig == SIGUSR1) {
        printf("Дочерний процесс: получен сигнал SIGUSR1\n");
        printf("Дочерний процесс: завершение работы\n");
        exit(0);
    }
}

/* ----------------------------------------------------*/
/* ФУНКЦИЯ main : основная функция дочернего процесса */
/* назначение этой функции: ожидание сигналов от родителя */
/* ИСПОЛЬЗОВАНИЕ ПАРАМЕТРА: */
/* argc - количество аргументов командной строки */
/* argv - массив аргументов командной строки */
/* ВЫЗЫВАЕМАЯ ФУНКЦИЯ: */
/* signal - установка обработчика сигналов */
/* getpid - получение идентификатора текущего процесса */
/* printf - вывод сообщения на экран */
/* pause - приостановка выполнения до получения сигнала */
/* exit - завершение процесса */
/* ----------------------------------------------------*/
int main(int argc, char *argv[]) {
    /* Установка обработчика для сигнала SIGUSR1 */
    signal(SIGUSR1, child_handler);
    
    /* Вывод информации о запуске процесса */
    printf("Дочерний процесс: запущен (PID: %d)\n", getpid());
    printf("Дочерний процесс: ожидание сигнала SIGUSR1...\n");
    
    /* Бесконечный цикл ожидания сигналов */
    while(1) {
        pause(); /* Приостановка выполнения до получения сигнала */
    }
    
    return 0; /* Эта строка никогда не выполнится */
}
